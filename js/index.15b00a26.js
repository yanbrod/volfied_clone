(()=>{var t,e,o={},r={};function l(t){var e=r[t];if(void 0!==e)return e.exports;var a=r[t]={exports:{}};return o[t](a,a.exports,l),a.exports}l.rv=function(){return"1.0.5"},l.ruid="bundler=rspack@1.0.5";let a=document.getElementById("gameCanvas"),n=a.getContext("2d"),f=a.width,i=a.height,y=f/4,h=i/4,x={x:f/2,y:i-4},d=[],F=!1,s=3,p=!1,u={LEFT:!1,RIGHT:!1,UP:!1,DOWN:!1},M=new Uint8Array(y*h);function m(t,e){return e*y+t}for(let t=0;t<y;t++)M[0*y+t]=1,M[(h-1)*y+t]=1;for(let e=0;e<h;e++){;M[e*y+0]=1,M[t=y-1,e*y+t]=1}let c=[];for(let t=0;t<3;t++)c.push({pos:{x:Math.floor(Math.random()*(y-2))+1,y:Math.floor(Math.random()*(h-2))+1},dir:{x:.5>Math.random()?-1:1,y:.5>Math.random()?-1:1}});document.addEventListener("keydown",t=>{"ArrowLeft"===t.key?u.LEFT=!0:"ArrowRight"===t.key?u.RIGHT=!0:"ArrowUp"===t.key?u.UP=!0:"ArrowDown"===t.key&&(u.DOWN=!0)}),document.addEventListener("keyup",t=>{"ArrowLeft"===t.key?u.LEFT=!1:"ArrowRight"===t.key?u.RIGHT=!1:"ArrowUp"===t.key?u.UP=!1:"ArrowDown"===t.key&&(u.DOWN=!1)});let g=document.createElement("canvas");g.width=f,g.height=i;let T=g.getContext("2d"),w=T.createImageData(f,i),v=w.data,A=0,k=33.333333333333336;let L=(e=Math.floor(x.x/4),Math.floor(x.y/4)*y+e);function R(){let t=0;for(let e=0;e<M.length;e++)1===M[e]&&t++;let e=2*y+(h-2)*2,o=t-e;return o/(y*h-e)*100}function D(){var t;s-=1,x={x:f/2,y:i-4},F=!1,d=[],u.LEFT=!1,u.RIGHT=!1,u.UP=!1,u.DOWN=!1,0===s&&console.log("Game Over"),t=Math.floor(x.x/4),L=Math.floor(x.y/4)*y+t}requestAnimationFrame(function t(e){e-A>=k&&(A=e,function(){let t=0,e=0;if(u.LEFT&&(t=-1),u.RIGHT&&(t=1),u.UP&&(e=-1),u.DOWN&&(e=1),0!==t||0!==e){0!==t&&0!==e&&(e=0);let o={x:x.x+4*t,y:x.y+4*e},r=Math.floor(o.x/4),l=Math.floor(o.y/4),a=l*y+r,n=M[L];r>=0&&r<y&&l>=0&&l<h&&(1===M[a]?(F&&(F=!1,function(){for(let t of d){let e=Math.floor(t.x/4);M[Math.floor(t.y/4)*y+e]=1}let t=new Uint8Array(M.length),e=[],o=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}];function r(o,r){let l=r*y+o;0===M[l]&&0===t[l]&&(e.push({x:o,y:r}),t[l]=1)}for(let t=0;t<y;t++)r(t,0),r(t,h-1);for(let t=0;t<h;t++)r(0,t),r(y-1,t);for(let t of c)r(t.pos.x,t.pos.y);for(;e.length>0;){let{x:t,y:l}=e.pop();for(let e of(M[l*y+t]=2,o)){let o=t+e.dx,a=l+e.dy;o>=0&&o<y&&a>=0&&a<h&&r(o,a)}}for(let t=0;t<M.length;t++)0===M[t]?M[t]=1:2===M[t]&&(M[t]=0);c=c.filter(t=>{var e;return 1!==M[e=t.pos.x,t.pos.y*y+e]})}(),d=[],R()>=75&&(p=!0)),x=o):(!F&&1===n&&(F=!0,d=[{x:x.x,y:x.y}]),x=o,F&&d.push({x:x.x,y:x.y})),L=a)}for(let t=c.length-1;t>=0;t--){let e=c[t],o=e.pos.x,r=e.pos.y,l=e.dir.x,a=e.dir.y;.1>Math.random()&&(l=Math.floor(3*Math.random())-1,a=Math.floor(3*Math.random())-1,0===l&&0===a&&(l=1),e.dir.x=l,e.dir.y=a);let n=o+l,f=r+a,i=f*y+n;n<0||n>=y||f<0||f>=h||1===M[i]?(l=Math.floor(3*Math.random())-1,a=Math.floor(3*Math.random())-1,0===l&&0===a&&(l=1),e.dir.x=l,e.dir.y=a):(e.pos.x=n,e.pos.y=f);let s=Math.floor(x.x/4),p=Math.floor(x.y/4);if(e.pos.x===s&&e.pos.y===p&&D(),F)for(let t of d){let o=Math.floor(t.x/4),r=Math.floor(t.y/4);if(e.pos.x===o&&e.pos.y===r){D();break}}}}(),function(){n.clearRect(0,0,f,i);let t={r:0,g:0,b:255,a:255},e=M.length;v.fill(0);for(let o=0;o<e;o++)if(1===M[o]){let e=o%y*4,r=4*Math.floor(o/y);for(let o=0;o<4;o++)for(let l=0;l<4;l++){let a=((r+l)*f+(e+o))*4;v[a]=t.r,v[a+1]=t.g,v[a+2]=t.b,v[a+3]=t.a}}if(T.putImageData(w,0,0),n.drawImage(g,0,0),d.length>0){n.strokeStyle="#00FF00",n.lineWidth=2,n.beginPath(),n.moveTo(d[0].x,d[0].y);for(let t=1;t<d.length;t++)n.lineTo(d[t].x,d[t].y);n.lineTo(x.x,x.y),n.stroke()}for(let t of(n.fillStyle="#FFFFFF",n.fillRect(x.x,x.y,4,4),c))n.fillStyle="#FF0000",n.fillRect(4*t.pos.x,4*t.pos.y,4,4);n.fillStyle="#FFFFFF",n.font="24px Arial",n.fillText(`Lives: ${s}`,10,30);let o=R();n.fillText(`Claimed: ${o.toFixed(1)}%`,10,60)}()),s>0&&!p?requestAnimationFrame(t):p?(n.fillStyle="#FFFFFF",n.font="48px Arial",n.fillText("You Win!",f/2-100,i/2)):(n.fillStyle="#FFFFFF",n.font="48px Arial",n.fillText("Game Over",f/2-100,i/2))})})();